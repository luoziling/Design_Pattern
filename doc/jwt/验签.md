## 验签

Java HS256签名算法

https://www.cnblogs.com/shaoyu/p/11881438.html

JSON Web Token（JWT）是一个非常轻巧的规范。这个规范允许我们使用JWT在用户和服务器之间传递安全可靠的信息。 服务器认证之后生成jwt，返回给用户。用户短期内就可以通过服务器签发的jwt来证实自己的合法性，此方案在一定程度上取代了传统的Cookie/session_id认证。**特别是在前后端分离多端适配的情况下。**零信任平台与指挥平台多端分离

Java jwt

https://github.com/auth0/java-jwt

**Available Algorithms**

The library implements JWT Verification and Signing using the following algorithms:

| JWS    | Algorithm | Description                            |
| ------ | --------- | -------------------------------------- |
| HS256  | HMAC256   | HMAC with SHA-256                      |
| HS384  | HMAC384   | HMAC with SHA-384                      |
| HS512  | HMAC512   | HMAC with SHA-512                      |
| RS256  | RSA256    | RSASSA-PKCS1-v1_5 with SHA-256         |
| RS384  | RSA384    | RSASSA-PKCS1-v1_5 with SHA-384         |
| RS512  | RSA512    | RSASSA-PKCS1-v1_5 with SHA-512         |
| ES256  | ECDSA256  | ECDSA with curve P-256 and SHA-256     |
| ES256K | ECDSA256  | ECDSA with curve secp256k1 and SHA-256 |
| ES384  | ECDSA384  | ECDSA with curve P-384 and SHA-384     |
| ES512  | ECDSA512  | ECDSA with curve P-521 and SHA-512     |

Using static secrets or keys:

```java
//HMAC
Algorithm algorithmHS = Algorithm.HMAC256("secret");

//RSA
RSAPublicKey publicKey = //Get the key instance
RSAPrivateKey privateKey = //Get the key instance
Algorithm algorithmRS = Algorithm.RSA256(publicKey, privateKey);
```

### Verify a Token

- Example using `HS256`

```java
String token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXUyJ9.eyJpc3MiOiJhdXRoMCJ9.AbIJTDMFc7yUa5MhvcP03nJPyCPzZtQcGEp-zWfOkEE";
try {
    Algorithm algorithm = Algorithm.HMAC256("secret");
    JWTVerifier verifier = JWT.require(algorithm)
        .withIssuer("auth0")
        .build(); //Reusable verifier instance
    DecodedJWT jwt = verifier.verify(token);
} catch (JWTVerificationException exception){
    //Invalid signature/claims
}
```

